---
title: "Cr√©ation de l'application Flots - Partie 1"
authors: ["Erwan COUBRET"]
tags: ["Application", "IA", "Organisation", "D√©veloppement"]
date: "16/02/2025"
---

# Cr√©ation de l'application Flots üåä - Partie 1

Depuis quelques mois, j'ai l'id√©e de d√©velopper une application qui permettrait de g√©rer √† la fois mes notes et mes t√¢ches, qui serait en quelque sorte un petit assistant personnel. Rien de r√©volutionnaire, mais j'aimerais avoir un outil optimal, permettant √† la fois une simplicit√© d'utilisation, tout en permettant une grande capacit√© de personnalisation. √âgalement, il faut qu'il soit accessible de partout : sur t√©l√©phone ou sur ordinateur. Pourquoi pas non plus y int√©grer un peu d'IA pour aider √† cette optimisation voulue.

J'ai commenc√© √† m'atteler √† ce projet lors de ces vacances de la Toussaint 2024 pour en poser les bases. D'autres projets, les trop nombreux partiels et les f√™tes de fin d'ann√©e m'ont pouss√© √† laisser ce d√©but d'application prendre la poussi√®re pendant quelques mois. Heureusement, il y a de cela quelques semaines j'ai pu reprendre son d√©veloppement et je pense qu'il m'en faudra encore quelques-unes pour avoir un prototype r√©ellement satisfaisant.

J'avais envie de partager un peu mes avancements ! J'ai d√©j√† eu l'occasion de le faire en interne sur le discord de la communaut√© Eos (ce site :) ), mais j'aimerais rajouter quelques compl√©ments aux bouts de codes et aux captures d'√©crans que j'envoie √† des heures al√©atoires de la nuit. Je vais donc vous expliquer un peu les backstages du projet : des id√©es et designs jusqu'aux choix des technos et leur impl√©mentation.

> Pour la petite pr√©sentation, je suis [Erwan COUBRET](https://www.erwancoubret.fr/) et je suis en √©cole d'ing√© sur Strasbourg. J'ai un cursus centr√© autour de l'informatique, avec une sp√©cialisation en IA et science des donn√©es depuis septembre dernier. N√©anmoins, il n'y a pas de d√©veloppement web et d'application dans nos programmes donc j'ai choisi de m'y int√©resser suite √† une opportunit√© de travail en freelance, et j'ai bien aim√© ! Apr√®s m'√™tre form√© et avoir travaill√© pendant 7/8 mois en tant que d√©veloppeur full-stack sur des projets existants, je me suis dit que cela pourrait √™tre rigolo de lancer sa propre appli pour apprendre les points que je n'avais pas eu l'occasion de d√©velopper.

---

<SectionTitle>
## Un bon commencement
</SectionTitle>

Je vais parler un peu du contexte et du design, pour mes vrais techos qui ne jurent que par les technos vous pouvez sauter √† la section *Le setup et les technos*.
### L'id√©e

L'initiative du d√©veloppement prend suite √† une remarque personnelle que je me suis faite l'√©t√© dernier : je ne connaissais pas d'application qui puisse me permettre de g√©rer mon emploi du temps et mes t√¢ches de mani√®re tr√®s mall√©able, tout en servant √©galement de d√©p√¥t pour des notes personnelles facilement organisables, avec un support [markdown](https://www.markdownguide.org/basic-syntax/) si possible.

J'ai remarqu√© que de nombreuses personnes (dont moi-m√™me) utilisent des messageries pour s'envoyer √† eux m√™me des messages informatifs, des contacts, etc. ou se servent de leur application de note native du t√©l√©phone pour se noter les choses √† faire et y r√©pertorier des infos en vrac. Des applications comme Notion, Obsidian existent d√©j√† et sont tr√®s utilis√©es et r√©pondent √† une partie des probl√©matiques, n√©anmoins elles demandent un temps d'appr√©hension assez long et sont clairement am√©liorables sur certains points pour avoir longuement essay√© les deux (et utilisant actuellement Obsidian pour √©crire ce post).

L'id√©e est alors d'essayer de d√©velopper moins d'outils qu'eux, mais de les optimiser au maximum pour une praticit√© √† l'usage quotidien. Pour les t√¢ches, j'ai √©galement eu l'occasion de travailler en freelance pour [Komia](https://www.komia.io/), un ERP pour les restaurateurs qui avait un syst√®me de t√¢ches tr√®s d√©velopp√© et que j'estime √™tre adaptable et am√©liorable pour une utilisation destin√©e au particulier.

<Note>
Il y aurait √©galement d'autres features √† d√©velopper que j'ai en t√™te mais il faudra attendre les prochains opus de cet article.
</Note>

### Maquette & Design

En tant que bon ing√©nieur, j'aime souvent commencer par le design?????!!! Non, il s'agit de quelque chose de plut√¥t rare pour notre genre, mais qui est tr√®s utile pour avoir une id√©e d'o√π l'on va (et il faut que je rentabilise mon abonnement adobe). Donc je sors [Illustrator](https://www.adobe.com/products/illustrator.html) pour commencer √† jeter 2/3 premi√®res id√©es de logos discutables, puis je m'attaque √† la maquette sur [Figma](https://www.figma.com/fr-fr/design/) pour visualiser la disposition des notes et des t√¢ches.

<Picture src="Figma1.png" />

Cette version ne restera pas longtemps en vigueur, et je prendrais du temps pour cr√©er une identit√© qui sera davantage convaincante. J'ai eu l'id√©e de "flots" comme nom sur un coup de t√™te, √ßa ressemblait √† "flow/workflow" et √ßa se prononce en anglais (‚ú®üåüfloTeSssüåü‚ú®). Pour coller avec le nom, il nous fallait une jolie vague en logo. J'ai donc pass√© 2 (DEUX!!) jours √† batailler avec des cercles dans le but d'avoir quelque chose de proportionnellement et de g√©om√©triquement correct, qui rende bien √† l‚Äô≈ìil de pr√®s et de loin. R√©sultat : 1 - je d√©teste les cercles ; mais : 2 - je suis plut√¥t content du r√©sultat !

Je vous laisse une premi√®re vision de l'enfer que j'ai v√©cu et toutes les versions n√©cessaires pour passer d'un petit dessin sur feuille A4 √† un logo bien propre ü§µ (les petites √©toiles ne vont pas rester mais j'aimais bien sur le coup)

<Picture src="IllustratorLogo1.png" />

<Picture src="Flots-logo.png" />

Et j'ai ensuite pu commencer √† faire un premier jet de la version mobile sur Figma gr√¢ce √† la nouvelle identit√© :

<Picture src="Pasted image 20250213232907.png" little/>

### Le setup et les technos

<Note>
Voici la section o√π l'on va perdre le commun de mortels ! N√©anmoins si le monde du web vous int√©resse et que vous souhaitez vous pencher sur ses grands principes, essayez de cerner les diff√©rences entre **backend** et **frontend**, j'ai lu en diagonal ce site qui a l'air pas mal : https://blog.lesjeudis.com/developpement-front-end-et-back-end-quelles-differences, sinon vous trouverez assez facilement par vous m√™me.
</Note>

Pour le **frontend**, j'ai choisi de me tourner vers [Ionic](https://ionicframework.com/), un framework qui permet d'adapter du [React](https://react.dev/) en code natif pour diff√©rents supports dont les mobiles. C'est √† dire qu'avec la m√™me base de code, je produis √† la fois la version web accessible sur les navigateurs, ainsi que la version mobile qui sera publi√©e sur les stores Android et iOS. Cela permet une grande rapidit√© de d√©veloppement. Pour le choix de ReactJS, il s'agit d'un framework que j'appr√©cie utiliser et dont j'en connais bien la logique.

Pour le **backend**, l'id√©e initiale fut de me tourner vers du [NodeJS](https://nodejs.org/en) avec [ExpressJS](https://expressjs.com/). L'avantage de ce combo est qu'il permet une grande mall√©abilit√© pour le code, avec donc aucune restriction d'architecture pour permettre de cr√©er quelque chose d'adapt√© √† chaque projet. N√©anmoins, il s'agit d'une m√©thode que je dirais *rustique* ü¶£, car elle demande de quasiment tout r√©-impl√©menter (les middelwares, pas d'orm, les syst√®mes d'authentification, etc.).

Toussaint dernier, avec [Sylvain BROCAS](https://www.linkedin.com/in/sylvain-brocas-b52571246/) qui souhaitait contribuer au d√©but du d√©veloppement de l'application, nous avons pris deux jours pour nous retrouver sur Paris et enfin nous mettre √† coder. C'est toujours plus sympa de donner un peu de concret aux projets sur lesquels on travaille. Apr√®s quelques heures pass√©es dans une biblioth√®que, vous pouvez observer mon grand sourire (üò¨) apr√®s avoir setup correctement le front et l'avoir lanc√© sur mon t√©l√©phone : 

<Picture src="Pasted image 20250213214002.png" />

En parall√®le, Sylvain s'occupait de configurer le backend, puis je l'ai rejoint pour que l'on puisse structurer le code avec des bases d'architecture hexagonale. Avoir une architecture avanc√©e n‚Äôest pas forc√©ment n√©cessaire pour de petits projets, mais je trouve int√©ressant d'essayer de configurer de soi-m√™me de telles structures. Cela implique quelques jours de setup en plus, mais ensuite tout roule facilement parce que le code est propre. Un mal pour un bien finalement.

Petite anecdote : en voulant retourner travailler dans la biblioth√®que le lendemain matin, on s'est rendu compte le nez devant la porte (apr√®s 45 min de m√©tro) qu'on √©tait un jour f√©ri√©, et que toutes les biblioth√®ques de la zone parisienne √©taient logiquement ferm√©es. On n'a pas trop trouv√© mieux comme id√©e de s'installer dans un parc et de nous remettre √† coder. √âvidemment il s'agissait du jour de la semaine o√π la temp√©rature avait bien descendu, alors on errait en qu√™te de bars/restos pour se r√©chauffer, et de prises pour que Sylvain puisse recharger la brique qui lui sert d'ordi. On vous laisse cette magnifique photo du moment o√π nous avions termin√© d'impl√©menter le premier visuel du frontend :

<Picture src="flots2.jpg" />

Pour la base de donn√©es, on a d'abord essay√© d'utiliser MongoDB, mais on s'est finalement tourn√© vers PostgreSQL qui est bien plus pratique d'utilisation et mall√©able selon nos besoins.

Apr√®s ces 2 jours parisiens, j'ai continu√© √† finir de configurer mon backend, cr√©er les middlewares, la gestion d'authentification avec les JWT. J'ai m√™me pris du temps pour faire une belle console avec des couleurs pour faciliter le d√©veloppement futur, on fait les choses biens quand m√™me ü§µ‚ú® :

<Picture src="Pasted image 20250215015226.png" />

Tout fier du setup du backend qui m'aura pris tout de m√™me quelques temps, j'envoie sur le serveur discord d'Eos si quelqu'un est disponible pour me donner des retours sur ce que j'ai fait, car je n'avais jamais mis en place moi-m√™me un backend. Je re√ßois alors un un fabuleux message qui m'indique un point crucial. Il me fera remarquer que de vouloir tout construire de soi m√™me sans utiliser de framework c'est certes tr√®s formateur, mais ce n'est pas pas trop utilisable : cela demande d'impl√©menter beaucoup de choses par soi-m√™me, souvent avec les premi√®res librairies qui tombent sous la main, en ayant pas forc√©ment conscience de potentielles failles de s√©curit√©, de probl√®mes de d√©pendances. Donc la proposition d'AdonisJS m'a pas mal plue. [Killian](https://www.linkedin.com/in/killianvincent/) m'a ensuite envoy√© 2 vid√©os de ***3 heures*** r√©alis√©es par quelqu'un de la core team d'Adonis et qui explique les avantages du framewor ... et elles m'ont clairement convaincues.

<Note>
Les voici : [Pr√©sentation d'AdonisJS 6](https://www.youtube.com/watch?v=eLNg9yelCqw), [Mod√®le MVC, architecture n-tier, hexagonal en TypeScript via AdonisJS 6](https://www.youtube.com/watch?v=bZRyqWImbPQ).
</Note>


<Picture src="Pasted image 20250214201003.png" />

Ces deux lignes de r√©ponses m'ont rajout√© quelques semaines de travail en plus car j'ai d√©cid√© de jeter tout le backend d√©j√† r√©alis√© pour le refaire avec Adonis. La techno est tr√®s modulable : d√©j√† elle n'impose pas d'architecture comme certains autres frameworks, ce que j'appr√©cie. Cela demande de s'assurer que tout est bien connect√© au niveau des configurations mais c'est faisable, et la techno laisse vraiment libre des outils que l'on souhaite utiliser en proposant une base (config, routing controller, env, hashing, etc.) √† laquelle on peut greffer tout un tas de modules comme un ORM, un service d‚Äôauthentification, et plein d'autres choses.

Je vous invite vraiment √† aller voir les vid√©os partag√©es plus haut, Romain LANZ fait vraiment un super taff explicatif d'Adonis, c'est l'une des personne de la core team du projet donc elle s'y conna√Æt vraiment.

Voil√† √† quoi ressemble l'architecture du back √† la fin de la configuration, et avec beaucoup de parties qui restent propres √† Adonis :

```sh
.
‚îú‚îÄ‚îÄ bin
‚îÇ   ‚îú‚îÄ‚îÄ console.ts
‚îÇ   ‚îú‚îÄ‚îÄ server.ts
‚îÇ   ‚îî‚îÄ‚îÄ test.ts
‚îú‚îÄ‚îÄ config
‚îÇ   ‚îú‚îÄ‚îÄ app.ts
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îú‚îÄ‚îÄ bodyparser.ts
‚îÇ   ‚îú‚îÄ‚îÄ cors.ts
‚îÇ   ‚îú‚îÄ‚îÄ database.ts
‚îÇ   ‚îú‚îÄ‚îÄ hash.ts
‚îÇ   ‚îú‚îÄ‚îÄ logger.ts
‚îÇ   ‚îî‚îÄ‚îÄ session.ts
‚îú‚îÄ‚îÄ database
‚îÇ   ‚îî‚îÄ‚îÄ migrations
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ src
‚îÇ   ‚îú‚îÄ‚îÄ env.ts
‚îÇ   ‚îú‚îÄ‚îÄ exceptions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handler.ts
‚îÇ   ‚îú‚îÄ‚îÄ kernel.ts
‚îÇ   ‚îú‚îÄ‚îÄ middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_middleware.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ container_bindings_middleware.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ force_json_response_middleware.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guest_middleware.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ silent_auth_middleware.ts
‚îÇ   ‚îú‚îÄ‚îÄ modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Note # (rien encore pour l'instant)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ User
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Application
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ Service
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_service.ts
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Validator
‚îÇ   ‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ user_validator.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Domain
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ Entity
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.ts
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Repository
‚îÇ   ‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ user_repository.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Infra
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Repository
‚îÇ   ‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ psql_user_repository.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ InterfaceAdapter
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ HttpController
‚îÇ   ‚îÇ               ‚îî‚îÄ‚îÄ user_controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ providers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_provider.ts
‚îÇ   ‚îî‚îÄ‚îÄ routes.ts
‚îú‚îÄ‚îÄ tests
‚îú‚îÄ‚îÄ sessions
...
```

Pour le syst√®me d'authentification, j'avais utilis√© sur le backend pr√©c√©dent un syst√®me de JsonWebToken, mais il s'agissait d'un choix non r√©fl√©chi car je ne connaissais que celui-l√†. Suite √† une explication des diff√©rents m√©canismes d'authentification gr√¢ce √† [cette vid√©o](https://www.youtube.com/watch?v=7ALYvSN8XZQ&t=780s) r√©alis√©e encore par Romain LANZ (quel goat), j'ai pris le choix de partir sur un syst√®me de sessions par fichiers.

Apr√®s quelques tests postman et incorporation d'un contexte d'authentification c√¥t√© frontend, on a un beau petit syst√®me de connexion / inscription : 

<Picture src="Pasted image 20250215094319.png" />

<Picture src="Pasted image 20250215094352.png" little/>

√Ä partir de l√† on a une bonne structure de projet. On va enfin pouvoir commencer le corps de l'application et ses fonctionnalit√©s.

---

<SectionTitle>
## Le corps du projet
</SectionTitle>

### La cr√©ation d'un classificateur de notes par IA

On avait parl√© au d√©but de l'article d'un syst√®me de classification automatique de notes, et bien c'est le moment de d√©velopper tout √ßa ü§ì. L'id√©e est de cr√©er un syst√®me de cat√©gories qui puissent √™tre sugg√©r√©es √† l'utilisateur lorsqu'il √©crit une note. D'ailleurs, les astres s'alignent bien, car l'un des cours de mon √©cole nous demandait de faire un projet de classification. J'en ai profit√© pour demander aux profs de faire passer cette partie de l'application comme projet et ils ont accept√© ü´°.

J'embrigade donc [Nathan WURPILLOT](https://www.linkedin.com/in/nathan-wurpillot-b187122b1/), mon duo habituel pour les projets de groupe √† l'√©cole avec lequel on est pas mal compl√©mentaires.

##### Recherche des mod√®les et constitution des classes

Avant de se lancer dans le code, il fallait d'abord √©tablir un syst√®me de classification pertinent. On a d√©fini une liste de 10 cat√©gories qui nous semblent regrouper la majorit√© des types de notes qu‚Äôun utilisateur pourrait r√©diger : *id√©e*, *liste*, *√©v√©nement*, *ressource*, *r√©union/compte-rendu*, *r√©flexion*, *t√¢che*, *veille*, *message*, et "*√† voir*" (vid√©os, livres, articles, ...). De plus on permet qu'un utilisateur puisse attribuer plusieurs cat√©gories √† une m√™me note.

##### Collecte et g√©n√©ration des donn√©es

Trouver un dataset qui colle vraiment au cadre de notre projet est difficile. Alors autant tester de cr√©er le n√¥tre. Probl√®me : il faut en g√©n√©ral beaucoup de donn√©es pour pouvoir obtenir un mod√®le satisfaisant, et si on regarde nos notes de nos t√©l√©phones, on est bien loin du compte. Alors on va essayer de siphonner les applications de notes de gens qu'on conna√Æt. On a mis en place un Google Forms qui expliquait notre d√©marche et on l'a partag√© en laissant la possibilit√© aux r√©pondants de classifier eux m√™mes leur note.

<Picture src="Pasted image 20250215224928.png" />

<Picture src="Pasted image 20250215231642.png" />

En deux jours on a r√©colt√© environ 80 r√©ponses, ce qui est pas mal mais qui est tr√®s loin d'√™tre suffisant, d'autant plus qu'on a d√ª en supprimer quelques-unes. On a aussi retir√© les infos trop personnelles qui n'avaient pas lieu d'√™tre donn√© en entra√Ænement √† un mod√®le. Apr√®s nettoyage on en avait plus qu'une soixantaine d'exploitable r√©parties ainsi :

```
cat√©gories de notes
ressource : 12, evenement : 3, idee : 7, a_voir : 8, message : 6, veille : 3, reflexion : 4, liste : 25, reunion : 3, t√¢ches : 6
```

On souhaite obtenir environ 50 notes par cat√©gorie diff√©rente. Avoir une bonne homog√©n√©it√© de pr√©sence est quelque chose d'important pour ne pas avoir un mod√®le qui √† terme ne favorise pas de cat√©gories en particulier. Comme vous pouvez l'observer, on est loin du compte. Fort heureusement, il existe un super g√©n√©rateur de texte qui marche encore mieux avec des instances d'exemple : chatgpt. En lui donnant les notes d'une certaine cat√©gorie, on a pu lui demander d'en g√©n√©rer d'autres qui pourraient appartenir √† cette m√™me cat√©gorie avec un habile prompt en ent√™te :

> Voici le travail, je vais envoyer un certains nombre de notes d'une certaine cat√©gorie (parmi l'ensemble des cat√©gories fourni pr√©c√©demment en instruction) et l'objectif sera d'en g√©n√©rer de nouvelles dans le m√™me style mais avec des variantes, potentiellement tournant autour d'autres th√®mes. Il faut garder en t√™te qu'il s'agit du type de notes que l'on peut noter sur son t√©l√©phone ou son ordinateur. Les notes seront g√©n√©r√©es en mode txt ou markdown (avec une variation entre les deux).

<Picture src="Pasted image 20250215232402.png" />

Ce prompt, nous l'avons am√©lior√© pour obtenir une structure de note plus ressemblante au r√©el :

> G√©n√®re moi des notes un peu plus longues et plus "humaines", avec des irr√©gularit√©s dans les espaces, √©ventuellement des fautes, des abr√©viations. Ne force pas trop la chose mais un humain a tendance √† ne pas avoir un style hyper carr√© pour de simples notes, n'indente pas tout parfaitement, n'ajoute pas de ## pour sp√©cifier de titre, de - pour sp√©cifier des listes, etc.

Apr√®s cela nous avons eu quelques r√©sultats plut√¥t satisfaisants, en voici des exemples :

```
Livres √† lire (ou relire)  
  1. L‚Äô√©tranger - Camus (d√©j√† commenc√©)  
  2. Le Comte de Monte-Cristo (gros pav√©, pr√©voir du temps)  
  3. Pourquoi j‚Äôai mang√© mon p√®re (l√©ger et dr√¥le ?)  
  4. Fahrenheit 451 (science-fiction, classique)  
  5. Demain les chiens (?? pas s√ªr du titre)  
  6. Les Fleurs du Mal (po√©sie)  
```
*Exemple de note g√©n√©r√©e de cat√©gorie liste*

```
Projets divers :  
refaire chambre - peinture bleue claire ou gris ?  
acheter √©tag√®re murale (ikea ou bricolage local)  
cours d‚Äôitalien - continuer appli ou prendre vrai prof ?  
test compost sur balcon, besoin de bac sp√©cial ?  
tenter yoga - vid√©o youtube ou salle √† tester ?  
```
*Exemple de note g√©n√©r√©e de cat√©gorie t√¢che (il s'en pose des questions chatgpt)*

```
tester combinaisons th√© + √©pices  
- cannelle & lavande  
- poivre noir & menthe  
- (doser pr√©cis, voir si r√©pulsif insectes ou juste bon go√ªt)  
```
*Petit bonus qui m'aura bien fait rigoler sur le coup, bien jou√© chatgpt*

Gr√¢ce √† cette m√©thode, nous avons pu arriver √† cette r√©partition plut√¥t homog√®ne de nos donn√©es.

<Picture src="Pasted image 20250216091638.png" />

##### Cr√©ation du premier mod√®le

On a ensuite cherch√© comment entra√Æner un mod√®le pour classifier ces notes. Nathan a test√© des m√©thodes classiques comme ***Bag of Words*** et ***TF-IDF***, qui fonctionnent bien sur des petits corpus (ensembles de mots) mais sont limit√©s sur des donn√©es textuelles complexes. Les r√©sultats n'√©tant pas satisfaisants, nous avons tent√© d'aller plus loin en se tournant vers des mod√®les plus puissants.

Nous avons opt√© pour le fine-tuning de ***BERT*** pour notre t√¢che de classification de notes. BERT est reconnu pour sa capacit√© √† saisir les nuances contextuelles du langage, ce qui le rend efficace pour les t√¢ches de compr√©hension. L‚Äôinconv√©nient de ce mod√®le est qu‚Äôil est relativement ancien : il est paru en 2018, et vous savez √† quelle vitesse √©voluent les LLMs ces derni√®res ann√©es. N√©anmoins, de par son anciennet√© et sa popularit√©, il existe de nombreuses ressources explicatives de son fonctionnement.

<Note>
Voil√† pour les curieux un super article qui explique en d√©tail le process de fonctionnement de BERT : [BERT for Sequence Classification from Scratch ‚Äî Code and Theory](https://medium.com/@alexmriggio/bert-for-sequence-classification-from-scratch-code-and-theory-fb88053800fa "https://medium.com/@alexmriggio/bert-for-sequence-classification-from-scratch-code-and-theory-fb88053800fa"). Et pour le m√™me prix une ressource qui explique le fonctionnement des transformers qui propose des visuels de haute vol√©e : [TRANSFORMER¬†EXPLAINER](https://poloclub.github.io/transformer-explainer/). C'est cadeau.
</Note>

Nous n'avons pas exactement utilis√© le mod√®le BERT mais ***DistilBERT***, une version all√©g√©e de BERT qui conserve une grande partie de ses performances tout en √©tant beaucoup moins lourd. Il est important d'utiliser des mod√®les l√©gers, car ils sont cens√©s tourner sur des serveurs pour qu'ils soient utilisables pour l'application (et c'est moi qui paierai ces serveurs donc le moins lourd c'est le mieux ü§ë). 

Le mod√®le a √©t√© entra√Æn√© sur notre petit dataset, et les r√©sultats sont plut√¥t satisfaisants : une accuracy de 75 %. Ce n‚Äôest pas parfait, mais ce n‚Äôest pas un probl√®me, car l'id√©e est simplement de sugg√©rer une cat√©gorie √† l'utilisateur. Ce sera lui qui aura toujours le dernier mot sur le choix des cat√©gories. C'est une bonne preuve de concept, au besoin on l'am√©liorera.

Comme vous avez pu l'observer, ce mod√®le est entra√Æn√© √† associer une note √† des √©l√©ments d'une liste de cat√©gories donn√©e. L'id√©al serait de pouvoir permettre √† l'utilisateur d'ajouter soi m√™me ses propres cat√©gories pour que l'application soit vraiment en accord avec la politique de personnalisation que j'aimerais lui donner.

##### Un mod√®le pour les cat√©gories personnalis√©es

Si un utilisateur ajoute sa propre classe, il est impossible d‚Äôentra√Æner un mod√®le sp√©cifique √† cela. Mais nous pouvons nous tourner sur le principe du ***Zero-Shot Learning***. Gr√¢ce √† certains mod√®les, on peut pr√©dire une cat√©gorie sans que le mod√®le ait √©t√© sp√©cifiquement entra√Æn√© dessus. Dans notre cas, nous utiliserons ***BART-large-mnli***.

Il suffit de lui fournir une liste de classes possibles avec sa description et il assigne la note √† la plus pertinente. Pour √©viter les erreurs absurdes, on a mis en place un seuil de confiance : si le score est trop bas, on ignore la suggestion.

Notre m√©thode finale combine donc notre mod√®le fine-tun√© pour les classes connues et le Zero-Shot Learning pour les nouvelles cat√©gories d√©finies par l‚Äôutilisateur. On garde ainsi un syst√®me √©volutif et flexible, qui peut s‚Äôadapter aux besoins de chacun sans avoir √† r√©-entra√Æner un mod√®le √† chaque ajout de classe.

### La cr√©ation des t√¢ches et des notes

En parall√®le du d√©veloppement du mod√®le, je m'attelle √† la r√©alisation du syst√®me de gestion de notes et de t√¢ches. J'imagine un petit dashboard pour la version pc de l'application avec les zones o√π iront les widgets :

<Picture src="Pasted image 20250216125848.png" />

Il s'agit d'un visuel tr√®s rustique mais je pense que j'avais besoin d'un peu coder et de me projeter dans la logique de l'application avant d'ensuite repenser le tout. 

La cr√©ation des notes est en soit tr√®s simple. Un titre, un contenu et une liste de cat√©gories auxquelles elles sont associ√©es, et c'est tout pour l'instant. Apr√®s cr√©ation des routes c√¥t√© api/backend, et tests de celles-ci avec [Bruno](https://www.usebruno.com/), un √©quivalent de postman open-source qui nous emb√™te pas tout le temps pour cr√©er un compte (allez voir c'est sympa, et leur logo de chien est trop moche c'est hilarant). Ensuite pour l'int√©gration c√¥t√© front, j'utilise la librairie [axios](https://axios-http.com/docs/intro) pour g√©rer les requ√™tes avec mes ent√™tes, la automatiquement les erreurs... J'utilise la librairie [Tanstack](https://tanstack.com/) (*anciennement react-query*), qui permet de faire une gestion des requ√™tes intelligemment avec des outils d'optimisation, de g√©rer les √©tats des requ√™tes (`loading`, `error`, `success`) ce qui est agr√©able √† ne pas recoder avec des useState et useEffect sur React.

Pour le widget, je l'ai fait sans maquette et pour le modal de cr√©ation de la note, j'ai utilis√© par simplicit√© les composants fournis par Ionic. C'est tr√®s pratique pour faire du d√©veloppement de features rapide mais ils ne permettent que peu de personnalisation, ce qui n'est pas viable pour une application qui se veut √™tre tr√®s propre dans son utilisation.

<Picture src="Pasted image 20250216130048.png" />

<Picture src="Pasted image 20250216130102.png" />

Pour les cat√©gories, on les ajoute les unes apr√®s les autres apr√®s des virgules, ce qui est tr√®s peu agr√©able mais qui permettait de tester correctement les notes avant qu'on impl√©mente un syst√®me de cat√©gorie proprement dans l'application.

La cr√©ation du syst√®me de t√¢ches √©tait davantage int√©ressante. Il y aura d√©j√† besoin d'une logique plus pouss√©e, et surtout il faut r√©fl√©chir √† de nombreux param√®tres. [Florian LOLLIVIER](https://www.linkedin.com/in/florian-lollivier/), qui est pas mal friand de ce genre d'applications, a produit des petits sch√©mas et a donn√© des exemples. On voit aussi qu'il diff√©rencie les t√¢ches plus ponctuelles des "habitudes" qui sont des t√¢ches r√©currentes selon le mois / la semaine.

<Picture src="Pasted image 20250216141452.png" little/>

<Picture src="Pasted image 20250216141501.png" little/>

L'id√©e gard√©e est de consid√©rer les habitudes comme des t√¢ches et d'√©ventuellement cr√©er plus tard des sections pour permettre de les dissocier. Au niveau de leur structure en base de donn√©es, ce sera la m√™me chose. Pour l'instant on a quelque chose qui ressemble √† √ßa pour l'entit√© `Task` :

```ts
export enum TaskStatus {
  TODO = 'todo',
  IN_PROGRESS = 'in_progress',
  DONE = 'done',
  SKIPPED = 'skipped',
}

export enum TaskType {
  UNIQUE = 'unique',
  WEEKLY = 'weekly',
  MONTHLY = 'monthly',
  YEARLY = 'yearly',
}

export enum ImportanceStatus {
  HIGH = 'high',
  MEDIUM = 'medium',
  LOW = 'low',
}

export interface SubTask {
  name: string
  status: TaskStatus
}

export interface UniqueTask {
  type: TaskType.UNIQUE
  startDate?: DateTime
  endDate?: DateTime
}

export interface WeeklyTask {
  type: TaskType.WEEKLY
  startDate?: DateTime
  endDate?: DateTime
  days: {
    day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday' | 'saturday' | 'sunday'
    time: string
  }[]
  endRecurrenceDate?: DateTime
}

export interface MonthlyTask {
  type: TaskType.MONTHLY
  startDate?: DateTime
  endDate?: DateTime
  week: 'first' | 'second' | 'third' | 'fourth' | 'last'
  day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday' | 'saturday' | 'sunday'
  time: string
  endRecurrenceDate?: DateTime
}

export interface YearlyTask {
  type: TaskType.YEARLY
  startDate?: DateTime
  endDate?: DateTime
  month:
    | 'january'
    | 'february'
    | 'march'
    | 'april'
    | 'may'
    | 'june'
    | 'july'
    | 'august'
    | 'september'
    | 'october'
    | 'november'
    | 'december'
  time: string
  day: number
}

export type TaskSchedule = UniqueTask | WeeklyTask | MonthlyTask | YearlyTask

export default class Task extends BaseModel {
  @column({ isPrimary: true })
  declare id: string

  @column()
  declare user_id: string

  @column()
  declare title: string

  @column()
  declare status: TaskStatus

  @column()
  declare description: string

  @column.dateTime()
  declare next_occurrence: DateTime | null

  @column()
  declare schedule: TaskSchedule

  @column()
  declare subtasks: SubTask[]

  @column()
  declare importance_status: ImportanceStatus | null
}
```

<Note>
Petite digression mais c'est vraiment agr√©able de bosser c√¥t√© backend et frontend sur le m√™me langage. L√† par exemple le fait de pouvoir copier/coller ces structures d'un c√¥t√© comme de l'autre c'est super, merci le javascript :)
</Note>

Le point cl√© dans la gestion des t√¢ches r√©currentes est de calculer correctement leur prochaine √©ch√©ance (le champ `next_occurrence`). Une t√¢che r√©currente doit appara√Ætre √† son √©ch√©ance pr√©vue, mais si elle n'est pas compl√©t√©e √† temps, elle ne doit pas √™tre automatiquement report√©e √† l'occurrence suivante avant d'avoir √©t√© r√©alis√©e.

Prenons un exemple concret : imaginons une t√¢che √† accomplir tous les mardis et jeudis (par exemple, le m√©nage). Si l'utilisateur oublie de la faire le mardi, elle doit rester visible et √™tre signal√©e comme en retard jusqu'√† ce qu'elle soit compl√©t√©e. L'application ne doit pas consid√©rer automatiquement que l‚Äôutilisateur a saut√© l‚Äô√©ch√©ance et la reporter √† jeudi, c'est √† l'utilisateur de le pr√©ciser.

Le calcul de la prochaine occurrence doit donc se faire uniquement lorsque la t√¢che est marqu√©e comme termin√©e. Si l‚Äôutilisateur ne compl√®te la t√¢che du mardi que le vendredi, l‚Äôapplication doit indiquer un retard de 3 jours et ne reprogrammer la t√¢che que pour le mardi suivant. Ainsi, l‚Äôapplication peut permettre un suivi rigoureux des t√¢ches et √©vite qu‚Äôelles ne disparaissent sans avoir √©t√© effectu√©es.

Voici ensuite le widget des t√¢ches ainsi que le modal de cr√©ation avec des r√©currences diff√©rentes :

<Picture src="Pasted image 20250216150045.png" />

<Picture src="Pasted image 20250216150225.png" />

<Picture src="Pasted image 20250216150232.png" />

Je n'appr√©cie vraiment pas cette organisation des param√®tres, et le design du modal de cr√©ation que je trouve profond√©ment non-intuitive. Mais ne vous inqui√©tez pas, j'ai des id√©es pour am√©liorer cela.

### La dockerisation et les cat√©gories

Roulement de tambours, j'ai enfin trouv√© quelqu'un pour m'accompagner sur le long terme pour le projet. Il s'agit d'[Adrien JAYAT](https://www.linkedin.com/in/adrien-jayat/) qui est dans ma formation et qui trouve que le projet est un bon pr√©texte pour se mettre au web :) Il a quelques exp√©riences niveau infrastructure de projets, en pipelines CI/CD. Il s'est occup√© de dockeriser proprement le backend. C'√©tait un peu long de setup les bases de donn√©es √† chaque fois √† la main, franchement il a g√©r√© c'est vraiment pratique. Il a aussi fait en sorte de pouvoir run le backend sur le r√©seau local, √ßa demande un peu de config mais √ßa nous permettra de tester l'application facilement sur mobile.

Il a aussi commenc√© son apprentissage d'Adonis en mettant en place la structure des cat√©gories et en faisant le controller. On a fait en sorte de ne pas se marcher dessus avec des Pull-Requests et des noms de commits cleans. De plus, quand on fait des modifications sur le backend, on demande √† l'autre de v√©rifier nos codes avant de merger. C'est forc√©ment un peu plus de temps de mise en place, mais √ßa vaut vraiment le coup de prendre des plis de d√©veloppement professionnels. Le projet est bien plus propre comme cela et il nous √©vitera de g√©rer des millions de conflits.

<Picture src="Pasted image 20250216171504.png" />

Parlons des cat√©gories. Elles auront une structure tr√®s simple. Un nom, une description pour permettre √† l'utilisateur de pr√©ciser des informations pour faciliter leur d√©tection. On relit ensuite l'entit√© aux tables de notes et de t√¢ches gr√¢ce √† une table de pivot. On permet aussi d'ajouter une couleur √† la tache, c'est pas encore impl√©ment√© mais √ßa le sera.

```ts
export default class Category extends BaseModel {
  @column({ isPrimary: true })
  declare id: string

  @column()
  declare user_id: string

  @column()
  declare name: string

  @column()
  declare description: string

  @column()
  declare color: string

  @manyToMany(() => Note, {
    pivotTable: 'category_note',
  })
  declare notes: ManyToMany<typeof Note>

  @manyToMany(() => Task, {
    pivotTable: 'category_task',
  })
  declare tasks: ManyToMany<typeof Task>
}
```

### Connexion de notre mod√®le √† l'appli

Vient maintenant le dernier point de cet article. Il s'agit du moment o√π nous allons relier notre mod√®le de pr√©diction de cat√©gories √† l'application. Pour cela nous nous sommes retrouv√©s chez Nathan, avec la compagnie de [Dorian CHEVALERIAS](https://www.dorian-chevalerias.com/), un mec tr√®s sympa de notre √©cole et chaud en IA. Il nous a pr√©sent√© [FastAPI](https://fastapi.tiangolo.com/), un framework qui permet de d√©velopper tr√®s facilement une API python pour notre mod√®le.

On a cod√© une bonne aprem jusqu'√† 2h du mat, avec un petit break raclette pour prendre des forces.

<Picture src="Pasted image 20250216150637.png" />

Ce n'est pas la soir√©e o√π j'ai √©t√© le plus utile, j'ai surtout fait en sorte de bien r√©cup√©rer les r√©sultats que renvoyait l'API. Quant √† eux ils ont g√©r√©s pour l'int√©gration du mod√®le. Franchement √ßa s'est fait tr√®s vite avec FastAPI, le framework porte bien son nom !

---

<SectionTitle>
## La suite ?
</SectionTitle>

Merci d'avoir lu jusqu'ici, vous en √™tes arriv√© √† la conclusion de ce pav√©. Le premier objectif maintenant est de repenser le design pour rendre l'application agr√©able d'utilisation, je vais essayer de faire en sorte qu'on ait notre style √† nous. Il reste encore √† coder la gestion de l'apparition des t√¢ches, avec le calcul des occurrences suivantes qu'on avait √©voqu√© plus t√¥t.

Pour arriver √† une V1 qui nous satisfera, il faudra encore faire une gestion des notifications de l'application sous ses diff√©rents supports (web/mobile), permettre de lier nos t√¢ches directement √† notre agenda. Pour le coup, √ßa on ne s'imagine vraiment pas en recoder un, c'est souvent gal√®re, on fera en sorte de pouvoir de lier l'appli √† des services existant.

Une fois qu'on aura tout √ßa, on commencera √† nous int√©resser au d√©ploiement, puis √† ajouter des nouvelles features, on en a quelques-unes en t√™te :)

### Un financement participatif ?

Plus le temps avance, plus je me dis que ce projet serait id√©al pour qu'on le partage sur une plateforme de crowdfunding. Cela permettrait de soutenir le paiement des infrastructures, la communication, et de nous accompagner financi√®rement dans le projet. Si l'id√©e vous int√©resse je vous laisse [me suivre sur Linkedin](https://www.linkedin.com/in/erwan-coubret/).

N√©anmoins je pense que cette campagne de financement ne commencera qu'√† mon retour en France apr√®s mon stage d'√©t√© √† l'autre bout du monde. J'estimerai que si elle voit le jout, ce sera autour de novembre 2025, nous n'y sommes pas encore.

### Le mot de la fin

J'esp√®re que ce format d'article vous a plu. Je suis heureux d'avoir r√©ussi √† faire un point presque exhaustif de l'√©tat de l'avancement du projet. Je suis √©videmment ouvert √† tout retour / toute critique sur cet article ou ce projet, les id√©es sont aussi les bienvenues.

Je me permets d'en profiter pour vanter l'initiative Eos, que je porte avec d'autres amis et comp√®res. Si l'article vous a plu, notamment le fait de voir les points techniques d'un projet comme celui-ci, cela pourrait vous int√©resser. Notre objectif et de mettre en avant et d'encourager les "jeunes" lanceurs de projets dans le monde de la tech. Nous essayons de mobiliser dans un endroit commun des gens qui ont envie de faire des choses sympas, de collaborer, de recevoir des retours. Je vous laisse explorer ce site pour en apprendre plus, mais si vous voulez voir en temps r√©el la suite du projet, vous savez o√π aller.

J'aimerais encore une fois remercier tous les gens qui ont particip√© de pr√®s ou de loin √† cette application, que ce soit √©videmment ceux qui y ont particip√© directement, comme ceux qui donnent leurs avis ou impressions.

Je vous dis √† dans quelques mois pour le prochain opus de cette s√©rie.

√Ä+,

Erwan